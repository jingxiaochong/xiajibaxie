<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <button>跳转</button>
    </title>
</head>

<body>

</body>
<script>
    current = location.href;
    setTimeout('reload()', 100);
    var iframe
    function reload() {
        var frame = '<frameset cols=\'*\'>\n<frame id="jingxc" src=\'' + current + '\' /></frameset>';
        with (document) {
            write(frame);
            void (close());
        };
        iframe = document.getElementById('jingxc');
        iframe.onload = function name(params) {
            const iframeElement = iframe.contentWindow.document.querySelector('.confirm-btn');
            if (iframeElement) {
                console.log(iframeElement);
            }
            if (iframeElement && iframeElement.textContent == '确定') {
                iframeElement.click()
            } else {
                setTimeout('reload()', 100);
            }
        }
        iframe.addEventListener('load', function () {
            const iframeElement = iframe.contentWindow.document.querySelector('.confirm-btn');
            if (iframeElement) {
                console.log(iframeElement);
            }
            // 监听加载完毕 如果到了填写页面
            if (iframe.contentWindow.document.querySelector('.add-person')) {
                iframe.contentWindow.document.getElementsByClassName('add-person')[0].click()

                setTimeout(() => {
                    let evt = iframe.contentWindow.document.createEvent('HTMLEvents');
                    evt.initEvent('input', true, true);

                    iframe.contentWindow.document.getElementsByClassName('view_form-input')[0].value = '井晓冲';
                    iframe.contentWindow.document.getElementsByClassName('view_form-input')[0].dispatchEvent(evt)

                    iframe.contentWindow.document.getElementsByClassName('view_form-input')[2].value = '411121199808210015';
                    iframe.contentWindow.document.getElementsByClassName('view_form-input')[2].dispatchEvent(evt)
                }, 0);
            }
        });
    }









    let num = 0
    current = location.href;
    setTimeout('reload()', 100);
    var iframe
    function reload() {
        num += 1
        console.log(num);
        var frame = '<frameset cols=\'*\'>\n<frame id="jingxc" src=\'' + current + '\' /></frameset>';
        with (document) {
            write(frame);
            void (close());
        };
        iframe = document.getElementById('jingxc');
        iframe.addEventListener('load', function () {
            const iframeElement = iframe.contentWindow.document.querySelector('.confirm-btn');
            console.log(iframeElement);
            if (iframeElement && iframeElement.textContent == '确定') {
                iframeElement.click()
                // iframe.src = 'https://6566d890783b53000119b89d.caiyicloud.com/reserve/reserve-detail/personinfo'
            } else {
                setTimeout('reload()', 100);
            }
            // 监听加载完毕 如果到了填写页面
            if (iframe.contentWindow.document.querySelector('.add-person')) {
                iframe.contentWindow.document.getElementsByClassName('add-person')[0].click()

                setTimeout(() => {
                    let evt = iframe.contentWindow.document.createEvent('HTMLEvents');
                    evt.initEvent('input', true, true);

                    iframe.contentWindow.document.getElementsByClassName('view_form-input')[0].value = '井晓冲';
                    iframe.contentWindow.document.getElementsByClassName('view_form-input')[0].dispatchEvent(evt)

                    iframe.contentWindow.document.getElementsByClassName('view_form-input')[2].value = '411121199808210015';
                    iframe.contentWindow.document.getElementsByClassName('view_form-input')[2].dispatchEvent(evt)
                }, 0);
            }
        });
    }

</script>

</html>